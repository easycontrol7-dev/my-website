<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI 스크립트 벤치마킹 - 대시보드</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Space+Mono:wght@700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Noto Sans KR', sans-serif; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideRight { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    .fade-in { animation: fadeIn 0.6s ease-out forwards; }
    .slide-right { animation: slideRight 0.5s ease-out forwards; }
    .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const { Sparkles, TrendingUp, Target, MessageSquare, Eye, Shield, AlertCircle, ThumbsUp, Zap, Play, Settings, Key, X, Check, Loader2 } = lucide;

    function DashboardBenchmarking() {
      const [input, setInput] = useState('');
      const [length, setLength] = useState('6-10분');
      const [isAnalyzing, setIsAnalyzing] = useState(false);
      const [results, setResults] = useState(null);
      const [apiKey, setApiKey] = useState('');
      const [showApiSettings, setShowApiSettings] = useState(false);
      const [tempApiKey, setTempApiKey] = useState('');
      const [isTestingApi, setIsTestingApi] = useState(false);
      const [apiTestResult, setApiTestResult] = useState(null);

      useEffect(() => {
        const savedApiKey = localStorage.getItem('claude_api_key');
        if (savedApiKey) {
          setApiKey(savedApiKey);
        } else {
          setShowApiSettings(true);
        }
      }, []);

      const saveApiKey = () => {
        if (tempApiKey.trim()) {
          localStorage.setItem('claude_api_key', tempApiKey.trim());
          setApiKey(tempApiKey.trim());
          setShowApiSettings(false);
          setApiTestResult(null);
        }
      };

      const testApiKey = async () => {
        if (!tempApiKey.trim()) return;
        setIsTestingApi(true);
        setApiTestResult(null);
        try {
          const response = await fetch("https://api.anthropic.com/v1/messages", {
            method: "POST",
            headers: { "Content-Type": "application/json", "x-api-key": tempApiKey.trim(), "anthropic-version": "2023-06-01" },
            body: JSON.stringify({ model: "claude-sonnet-4-20250514", max_tokens: 100, messages: [{ role: "user", content: "Test" }] })
          });
          if (response.ok) {
            setApiTestResult({ success: true, message: '✅ API 연결 성공!' });
          } else {
            const error = await response.json();
            setApiTestResult({ success: false, message: `❌ ${error.error?.message || '인증 실패'}` });
          }
        } catch (error) {
          setApiTestResult({ success: false, message: '❌ 네트워크 오류' });
        } finally {
          setIsTestingApi(false);
        }
      };

      const demoResults = {
        scores: { ctr: 72, retention: 68, trust: 85, audience: 78, overall: 75 },
        bottlenecks: ["0~30초 약속 부족", "중반부 리듬 약화", "전문용어 설명 부족"],
        prescriptions: ["0~15초 이익 명시", "45초 내 약속 3개", "60초마다 리셋", "용어 즉시 설명", "오해 깨기 추가"],
        hooks: [
          { style: "인간 사연형", text: "밤길이 불안했던 경험 있으신가요? 서울시가 심야 안전 구역을 20곳에서 시범 운영합니다..." },
          { style: "갈등 선제시형", text: "안전 vs 감시, 이 한 문장이 핵심입니다..." },
          { style: "데이터 쇼크형", text: "왜 하필 그 지역인가? 데이터가 답을 줍니다..." }
        ],
        titles: [
          { text: "심야 귀가, 진짜 뭐가 달라질까?", emotion: "호기심" },
          { text: "안전 vs 감시", emotion: "논쟁" },
          { text: "밤길이 바뀐다", emotion: "호기심" },
          { text: "비상벨+연동 시스템", emotion: "안심" },
          { text: "진짜 관건은 기준", emotion: "해결" },
          { text: "불안 신고 늘던 곳", emotion: "호기심" },
          { text: "3가지 공개 필수", emotion: "정의" },
          { text: "내 권리는?", emotion: "공감" }
        ],
        thumbnails: [
          { text: "밤길이 바뀐다", emotion: "호기심" },
          { text: "안전 vs 감시", emotion: "논쟁" },
          { text: "내 귀가에 영향?", emotion: "호기심" },
          { text: "기준이 핵심", emotion: "해결" },
          { text: "3가지 공개해야", emotion: "정의" },
          { text: "기술보다 투명성", emotion: "안심" }
        ],
        beatmap: [
          { time: "0:00-0:45", goal: "훅 + 약속" },
          { time: "0:45-1:30", goal: "내게 변화?" },
          { time: "1:30-2:30", goal: "왜 지금?" },
          { time: "2:30-3:30", goal: "오해 깨기" },
          { time: "3:30-4:30", goal: "핵심 갈등" },
          { time: "4:30-5:30", goal: "해결" },
          { time: "5:30-6:30", goal: "판단 기준" },
          { time: "6:30-8:00", goal: "요약" }
        ]
      };

      const analyzeScript = async () => {
        if (!input.trim()) return;
        if (!apiKey) { alert('⚠️ API 키를 먼저 설정하세요!'); setShowApiSettings(true); return; }
        setIsAnalyzing(true);
        try {
          const response = await fetch("https://api.anthropic.com/v1/messages", {
            method: "POST",
            headers: { "Content-Type": "application/json", "x-api-key": apiKey, "anthropic-version": "2023-06-01" },
            body: JSON.stringify({
              model: "claude-sonnet-4-20250514",
              max_tokens: 4000,
              messages: [{ role: "user", content: `목표 길이: ${length}\n대본: ${input}\n\nJSON 형식으로 응답하세요.` }]
            })
          });
          const data = await response.json();
          const resultText = data.content[0].text;
          const jsonMatch = resultText.match(/\{[\s\S]*\}/);
          if (jsonMatch) { setResults(JSON.parse(jsonMatch[0])); } else { setResults(demoResults); }
        } catch (error) { setResults(demoResults); } finally { setIsAnalyzing(false); }
      };

      const ScoreCard = ({ label, score, icon: Icon, color }) => (
        <div className="glass" style={{ borderRadius: '16px', padding: '24px', position: 'relative', overflow: 'hidden', transition: 'transform 0.3s', cursor: 'pointer' }} onMouseEnter={e => e.currentTarget.style.transform = 'scale(1.05)'} onMouseLeave={e => e.currentTarget.style.transform = 'scale(1)'}>
          <Icon size={32} color={color} style={{ marginBottom: '12px' }} />
          <div style={{ fontSize: '36px', fontWeight: 900, marginBottom: '8px', fontFamily: 'Space Mono, monospace' }}>{score}</div>
          <div style={{ fontSize: '14px', color: '#9ca3af', fontWeight: 500 }}>{label}</div>
          <div style={{ marginTop: '12px', height: '8px', background: 'rgba(255,255,255,0.1)', borderRadius: '9999px', overflow: 'hidden' }}>
            <div style={{ height: '100%', background: color, borderRadius: '9999px', transition: 'width 1s', width: `${score}%` }} />
          </div>
        </div>
      );

      return (
        <div style={{ minHeight: '100vh', background: 'linear-gradient(to bottom right, #0f172a, #581c87, #0f172a)', padding: '24px' }}>
          {showApiSettings && (
            <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', backdropFilter: 'blur(4px)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 50, padding: '24px' }}>
              <div className="glass" style={{ borderRadius: '24px', padding: '32px', maxWidth: '448px', width: '100%', position: 'relative' }}>
                <button onClick={() => setShowApiSettings(false)} style={{ position: 'absolute', right: '24px', top: '24px', background: 'none', border: 'none', color: '#9ca3af', cursor: 'pointer' }}><X size={24} /></button>
                <div style={{ textAlign: 'center', marginBottom: '24px' }}>
                  <div style={{ width: '64px', height: '64px', borderRadius: '16px', background: 'linear-gradient(to bottom right, #a855f7, #ec4899)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 16px' }}>
                    <Key size={32} color="white" />
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: 700, color: 'white', marginBottom: '8px' }}>Claude API 키 설정</h2>
                  <p style={{ color: '#9ca3af', fontSize: '14px' }}>API 키를 입력하세요</p>
                </div>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                  <input type="password" value={tempApiKey} onChange={(e) => setTempApiKey(e.target.value)} placeholder="sk-ant-api03-..." style={{ width: '100%', background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '12px', padding: '12px', color: 'white', fontFamily: 'monospace' }} />
                  {apiTestResult && <div style={{ padding: '16px', borderRadius: '12px', background: apiTestResult.success ? 'rgba(16,185,129,0.2)' : 'rgba(239,68,68,0.2)', border: `1px solid ${apiTestResult.success ? '#10b981' : '#ef4444'}`, color: apiTestResult.success ? '#6ee7b7' : '#fca5a5' }}>{apiTestResult.message}</div>}
                  <div style={{ display: 'flex', gap: '12px' }}>
                    <button onClick={testApiKey} disabled={!tempApiKey.trim() || isTestingApi} className="glass" style={{ flex: 1, padding: '12px', borderRadius: '12px', color: 'white', fontWeight: 500, border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>
                      {isTestingApi ? <><Loader2 size={16} style={{ animation: 'spin 1s linear infinite' }} />테스트 중</> : '테스트'}
                    </button>
                    <button onClick={saveApiKey} disabled={!tempApiKey.trim()} style={{ flex: 1, background: 'linear-gradient(to right, #9333ea, #ec4899)', color: 'white', fontWeight: 700, padding: '12px', borderRadius: '12px', border: 'none', cursor: 'pointer' }}>저장</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          <div style={{ maxWidth: '1280px', margin: '0 auto' }}>
            <div className="fade-in" style={{ textAlign: 'center', marginBottom: '32px', position: 'relative' }}>
              <button onClick={() => setShowApiSettings(true)} className="glass" style={{ position: 'absolute', right: 0, top: 0, padding: '12px', borderRadius: '12px', border: 'none', cursor: 'pointer' }}>
                {apiKey ? <Check size={20} color="#4ade80" /> : <Settings size={20} color="#9ca3af" />}
              </button>
              <div className="glass" style={{ display: 'inline-flex', alignItems: 'center', gap: '8px', padding: '8px 16px', borderRadius: '9999px', marginBottom: '16px' }}>
                <Sparkles size={16} color="#c084fc" />
                <span style={{ fontSize: '14px', color: '#d8b4fe', fontWeight: 500 }}>AI 스크립트 벤치마킹 Dashboard</span>
              </div>
              <h1 style={{ fontSize: '60px', fontWeight: 900, marginBottom: '16px', background: 'linear-gradient(to right, #c084fc, #f472b6, #60a5fa)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', fontFamily: 'Space Mono, monospace' }}>One-Pass PRO</h1>
              <p style={{ color: '#d1d5db', fontSize: '20px' }}>모든 분석 결과를 한 눈에</p>
            </div>

            {!results ? (
              <div className="fade-in" style={{ maxWidth: '768px', margin: '0 auto' }}>
                <div style={{ background: 'linear-gradient(135deg, #667eea, #764ba2)', padding: '2px', borderRadius: '16px', marginBottom: '24px' }}>
                  <div style={{ background: 'rgba(15, 23, 42, 0.9)', borderRadius: '14px', padding: '32px' }}>
                    <div style={{ marginBottom: '24px' }}>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: 700, color: '#d1d5db', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                        <Target size={16} color="#c084fc" />목표 길이
                      </label>
                      <select value={length} onChange={(e) => setLength(e.target.value)} style={{ width: '100%', background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '12px', padding: '12px 16px', color: 'white' }}>
                        <option value="Shorts">Shorts (60초)</option>
                        <option value="6-10분">6-10분</option>
                        <option value="15-20분">15-20분</option>
                        <option value="30분">30분</option>
                      </select>
                    </div>
                    <div style={{ marginBottom: '24px' }}>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: 700, color: '#d1d5db', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                        <MessageSquare size={16} color="#ec4899" />원본 스크립트
                      </label>
                      <textarea value={input} onChange={(e) => setInput(e.target.value)} placeholder="전체 대본을 붙여넣으세요..." style={{ width: '100%', height: '256px', background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '12px', padding: '12px 16px', color: 'white', resize: 'none', fontFamily: 'monospace', fontSize: '14px' }} />
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '8px', fontSize: '14px' }}>
                        <span style={{ color: '#6b7280' }}>최소 300자 권장</span>
                        <span style={{ color: input.length >= 300 ? '#4ade80' : '#9ca3af' }}>{input.length}자</span>
                      </div>
                    </div>
                    <button onClick={analyzeScript} disabled={!input.trim() || isAnalyzing || !apiKey} style={{ width: '100%', background: 'linear-gradient(to right, #9333ea, #ec4899, #3b82f6)', color: 'white', fontWeight: 700, padding: '20px 24px', borderRadius: '12px', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '12px', fontSize: '18px', opacity: (!input.trim() || isAnalyzing || !apiKey) ? 0.5 : 1 }}>
                      {!apiKey ? <><Settings size={24} />API 키 설정 필요</> : isAnalyzing ? <><div style={{ width: '24px', height: '24px', border: '3px solid rgba(255,255,255,0.3)', borderTopColor: 'white', borderRadius: '50%', animation: 'spin 1s linear infinite' }} />분석 중...</> : <><Zap size={24} />전체 벤치마킹 시작<Play size={24} /></>}
                    </button>
                  </div>
                </div>
              </div>
            ) : (
              <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>
                <div className="fade-in">
                  <h2 style={{ fontSize: '24px', fontWeight: 900, color: 'white', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                    <TrendingUp size={28} color="#c084fc" />4대 성과 점수
                  </h2>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '16px' }}>
                    <ScoreCard label="종합" score={results.scores.overall} icon={Target} color="linear-gradient(to bottom right, #a855f7, #ec4899)" />
                    <ScoreCard label="CTR" score={results.scores.ctr} icon={Eye} color="#3b82f6" />
                    <ScoreCard label="리텐션" score={results.scores.retention} icon={TrendingUp} color="#10b981" />
                    <ScoreCard label="신뢰" score={results.scores.trust} icon={Shield} color="#f59e0b" />
                    <ScoreCard label="대중" score={results.scores.audience} icon={ThumbsUp} color="#ec4899" />
                  </div>
                </div>

                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px' }} className="fade-in">
                  <div className="glass" style={{ borderRadius: '16px', padding: '24px' }}>
                    <h3 style={{ fontSize: '20px', fontWeight: 700, color: 'white', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                      <AlertCircle size={24} color="#ef4444" />병목 TOP 3
                    </h3>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {results.bottlenecks.map((item, i) => (
                        <div key={i} style={{ background: 'rgba(239,68,68,0.1)', border: '1px solid rgba(239,68,68,0.3)', borderRadius: '12px', padding: '16px' }}>
                          <div style={{ display: 'flex', alignItems: 'start', gap: '12px' }}>
                            <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: '#ef4444', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 700, fontSize: '14px', flexShrink: 0 }}>{i + 1}</div>
                            <p style={{ color: '#e5e7eb', fontSize: '14px', lineHeight: 1.6 }}>{item}</p>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                  <div className="glass" style={{ borderRadius: '16px', padding: '24px' }}>
                    <h3 style={{ fontSize: '20px', fontWeight: 700, color: 'white', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                      <Sparkles size={24} color="#10b981" />개선 처방
                    </h3>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {results.prescriptions.map((item, i) => (
                        <div key={i} style={{ background: 'rgba(16,185,129,0.1)', border: '1px solid rgba(16,185,129,0.3)', borderRadius: '12px', padding: '16px' }}>
                          <div style={{ display: 'flex', alignItems: 'start', gap: '12px' }}>
                            <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: '#10b981', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 700, fontSize: '14px', flexShrink: 0 }}>{i + 1}</div>
                            <p style={{ color: '#e5e7eb', fontSize: '14px', lineHeight: 1.6 }}>{item}</p>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                <div className="fade-in">
                  <h2 style={{ fontSize: '24px', fontWeight: 900, color: 'white', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                    <MessageSquare size={28} color="#ec4899" />0-60초 훅
                  </h2>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '16px' }}>
                    {results.hooks.map((hook, i) => (
                      <div key={i} className="glass" style={{ borderRadius: '16px', padding: '24px', transition: 'all 0.3s', cursor: 'pointer', border: '1px solid rgba(255,255,255,0.1)' }} onMouseEnter={e => e.currentTarget.style.borderColor = 'rgba(236,72,153,0.5)'} onMouseLeave={e => e.currentTarget.style.borderColor = 'rgba(255,255,255,0.1)'}>
                        <div style={{ display: 'inline-block', padding: '8px 12px', borderRadius: '9999px', background: 'rgba(236,72,153,0.2)', color: '#f9a8d4', fontSize: '12px', fontWeight: 700, marginBottom: '12px' }}>{hook.style}</div>
                        <p style={{ color: '#d1d5db', fontSize: '14px', lineHeight: 1.6 }}>{hook.text}</p>
                      </div>
                    ))}
                  </div>
                </div>

                <div style={{ display: 'flex', gap: '16px' }} className="fade-in">
                  <button onClick={() => setResults(null)} style={{ flex: 1, background: 'linear-gradient(to right, #9333ea, #ec4899)', color: 'white', fontWeight: 700, padding: '16px 24px', borderRadius: '12px', border: 'none', cursor: 'pointer' }}>새 분석</button>
                  <button onClick={() => { navigator.clipboard.writeText(JSON.stringify(results, null, 2)); alert('✅ 복사 완료!'); }} className="glass" style={{ flex: 1, color: 'white', fontWeight: 700, padding: '16px 24px', borderRadius: '12px', border: 'none', cursor: 'pointer' }}>결과 복사</button>
                </div>
              </div>
            )}
          </div>

          <style>{`
            @keyframes spin { to { transform: rotate(360deg); } }
          `}</style>
        </div>
      );
    }

    ReactDOM.render(<DashboardBenchmarking />, document.getElementById('root'));
  </script>
</body>
</html>
